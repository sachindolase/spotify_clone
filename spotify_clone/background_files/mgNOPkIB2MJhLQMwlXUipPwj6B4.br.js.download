var SvCtrlV2;(function(n){n.SavableEntityCN="isv";n.SavedCN="saved";n.SaveCtrlContainerCN="isvctrl";n.FlyoutErrorCN="err";n.InProgressCN="ing";n.GetErrCN="b_geterr";n.FocusCN="isvfoc";n.HoverCN="b_isvhvr";n.SaveCtrlHoveredCN="b_schvr";n.CurrentElementCN="b_isvcur";n.NarrowImageCN="b_nrrwimg";n.NarrowImageRightCN="b_nrrwimgr";n.NarrowImageBottomCN="b_nrrwimgb";n.HasFlyoutCN="b_flyt";n.FlyoutActiveCN="b_scactive";n.SublabelActiveCN="b_scslbl";n.ErrDispCN="b_scdisp";n.DeactivateCN="scdactve";n.errStateVisibleCN="errvsbl";n.errStateInvisibleCN="errinvsbl";n.RemovableCN=[n.SavedCN,n.FocusCN,n.HoverCN,n.InProgressCN,n.FlyoutErrorCN,n.SaveCtrlHoveredCN];n.CollectionAttr="collection";n.CollectionItemIdAttr=n.CollectionAttr+"ItemId";n.IsSuccessAttr="isSuccess";n.ParentElementAttr="parentElement";n.UndefinedString="undefined";n.RelatedTargetAttr="relatedTarget";n.CurrentTargetAttr="currentTarget";n.TargetAttr="target";n.PixelUnit="px";n.SavesGenericItemDataAttr="data-saves-generic-item";n.ScrollBindDataAttr="data-scrbind";n.ClassListAttr="classList";n.CollectionIdDataAttribute="data-svcid";n.KCTDataAttr="data-svkct";n.SavedDataAttr="data-svd";n.SaveErrorMapAttr="data-save-error-map";n.CollRegisterEN="onCollRegister";n.PartnerRegisterEN="onPartnerRegister";n.DeregisterPersBtnEN="onDeregisterPersBtn";n.UpdateHoverBoxEN="onUpdateHoverBox";n.scEngagementEN="onSCEngagement";n.FocusInEN=["mouseenter","focusin"];n.FocusOutEN=["mouseleave","focusout"];n.CollListExpandEN="onCollListExpand";n.VisualStateChangedEN="onVisualStateChanged";n.CollectionsGottenEN="onCollectionsGotten";n.HostSavesControlClickedEN="onHostSavesControlClicked";n.PersButtonInteractEN="onPersButtonInteract";n.SaveAddEN="onSaveAdd";n.SaveDelEN="onSaveDel";n.SaveControlErrorEN="onSaveControlError";n.ControlAppendedEN="onControlAppended";n.CurrentCollIdSetEN="onCurrentCollIdSet";n.HoverElementSetEN="onHoverElementSet";n.SaveButtonClickEN="onSaveButtonClick";n.SaveButtonFocusEN="onSaveButtonFocus";n.ChevronToggleCollListEN="onBtnToggleCollList";n.FavAddEN="onFavAdd";n.FavDeleteEN="onFavDel";n.CollBCLoadedEN="CollectionsBCLoaded";n.CurrentElementSetEN="onCurrentElementSet";n.UpdateSaveStateEN="updateSaveState";n.TypeToAttributeMap={webdoc:"url",recipe:"sid",video:"mid",image:"cid",product:"cid"};n.ScrollEvent="scroll";n.ResizeEvent="resize";n.CustomCollDummyId="CustomCollId";n.IcnsBGColorCss="--icn-bg-color";n.IcnLblTxtClrCss="--svlbl-txt-color";n.SavedIcnCss="--svicn-bg-img";n.UnsavedIcnCss="--unsvicn-bg-img";n.SavedPromIcnCss="--svicn-bg-img-prominent";n.UnsavedPromIcnCss="--unsvicn-bg-img-prominent";n.SavePromClrCss="#5087EC";n.SavePromTxtClrCss="#FFFFFF";n.FlyoutBGClrCss="--flyout-bg-clr";n.FlyoutLnkClrCss="--flyout-lnk-clr";n.FlyoutTxtClrCss="--flyout-txt-clr";n.UiErrorStates=["Ok","AddItem","RemoveItem","GetCollection","CreateCollection","Mismatch","Intermittent","BadItemData"]})(SvCtrlV2||(SvCtrlV2={})),function(n){function y(t){return t&&l(t,n.SavableEntityCN)}function p(n,t){return!n&&!t?"":n?t?"type=".concat(n,"&Comp=").concat(t):"type=".concat(n):"Comp=".concat(t)}function i(n,t){try{var i=_d.elementsFromPoint(n,t)||[];return Array.prototype.slice.call(i)}catch(r){return[]}}function r(n,t){for(var r=n&&n.length||0,i=0;i<r;i++)t(n[i])}function w(n){try{return JSON.parse(n)}catch(t){return null}}function e(n,t){if(n)for(var i in n)t(i,n[i])}function b(n,t){var i=n;return e(t,function(n,t){i[n]=t}),i}function k(n){if(n&&n.target){var t=n.target.getBoundingClientRect(),u=t.x,f=t.right,e=t.y,o=t.bottom,s=i((u+f)/2,(e+o)/2);r(s,function(n){n.tagName==="A"&&n.hasAttribute("h")&&_w.si_T&&_w.si_T(n.getAttribute("h"))})}}function d(n,t){if(!(n&&t))return!1;try{return n.contains(t)}catch(i){return!1}}function o(n){if(!n)return null;try{return n.getBoundingClientRect()}catch(t){return null}}function g(n,t){var r;if(!(n&&t))return!1;try{if(r=o(n),!r)return;var u=r.x,f=r.y,e=i(u,f);return tt(e,t)}catch(s){return!1}}function nt(t){var i,r;if(!t||!n.localCollectionNames)return!1;i=t.toLowerCase();for(r in n.localCollectionNames)if(i==r.toLowerCase())return!0;return!1}function tt(n,t){try{return n&&n.length&&n.indexOf(t)>-1}catch(i){return!1}}function it(n,t){var i,r;return!n||!t?null:Element.prototype.closest?n.closest(t):(i=Element.prototype.matches?Element.prototype.matches:Element.prototype.webkitMatchesSelector?Element.prototype.webkitMatchesSelector:Element.prototype.msMatchesSelector,!i)?null:(r=function(n,t){var r=n;do{if(i.call(r,t))return r;r=r.parentElement||r.parentNode}while(r&&r.nodeType===1);return null},r(n,t))}function s(n){return n&&n.tagName==="A"}function t(n,t,i){n&&t&&i&&n.addEventListener(t,i)}function h(n,i){t(n,"keydown",function(n){n.keyCode==13&&i(n)})}function rt(n,i,r,u){if(r===void 0&&(r=!0),u===void 0&&(u=!0),n&&i){var f=s(n)?i:function(n){u&&(sj_pd(n),n.stopImmediatePropagation());i(n)};t(n,"click",f);r&&h(n,f)}}function ut(t,i){t&&i&&c(t,n.FocusInEN,i)}function ft(t,i){t&&i&&c(t,n.FocusOutEN,i)}function c(n,i,u){n&&u&&r(i,function(i){t(n,i,u)})}function l(t,i){if(!t||!i)return!1;var r=t[n.ClassListAttr];return r&&r.contains(i)}function a(t,i,r){t&&t[n.ClassListAttr]&&t[n.ClassListAttr][r](i)}function v(n,t){a(n,t,"add")}function u(n,t){a(n,t,"remove")}function f(n,t,i){n&&(v(n,i),u(n,t))}function et(t){t&&f(t,n.InProgressCN,n.FlyoutErrorCN)}function ot(t){t&&f(t,n.FlyoutErrorCN,n.InProgressCN)}function st(t){t&&u(t,n.InProgressCN)}function ht(n,t){var i,r,u;if(!(t&&t.content&&n))return!1;i=t.content;switch(i._type){case"ImageObject":return i.imageId===n.MediaId;case"VideoObject":return i.videoId===n.MediaId;case"GenericItem":if(n.ItemTagPath!==i.itemTagPath)return!1;if("contentId"in i&&"ContentId"in n)return i.contentId===n.ContentId;if(n.ClickThroughUrl!==i.url)return!1;if("CustomData"in n&&"customData"in i)try{if(r=JSON.parse(n.CustomData),u=JSON.parse(i.customData),"MediaUrl"in r||"MediaUrl"in u)return r.MediaUrl===u.MediaUrl}catch(f){return!1}return!0}return!1}function ct(n,t){var r=this,i;return t===void 0&&(t=300),function(){for(var f=[],u=0;u<arguments.length;u++)f[u]=arguments[u];sb_ct(i);i=sb_st(function(){n.apply(r,f)},t)}}n.isSavableEntity=y;n.getUrlParamsForTelemetry=p;n.elementsFromPoint=i;n.iterateThroughList=r;n.parseJsonString=w;n.iterateOverObject=e;n.objectAssign=b;n.fireOverlapping=k;n.elementContains=d;n.getClientRect=o;n.isElementInSpaceOfAnother=g;n.isCollectionExists=nt;n.getClosest=it;n.isAnchorElement=s;n.addListenerToElement=t;n.addEnterKeyListener=h;n.addClickListener=rt;n.addInListeners=ut;n.addOutListeners=ft;n.elementHasClass=l;n.addElementClass=v;n.removeElementClass=u;n.switchElementClass=f;n.switchElementToErrorClass=et;n.switchElementToInProgressClass=ot;n.removeInProgress=st;n.isDataPointingToSameItem=ht;n.debounce=ct}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){if(n.itemSchema||(n.itemSchema={}),t&&t.length>0){var i=t.split(":"),r=i[0],u=i[1];n.itemSchema[r]=u}}function i(t){var i;if(!t)return null;if(i=t.dataset,i){var r=i.svptnk,u=i.svptnerinfo,f=i.svitminfp,e=i.svcptid,o=i.ufmc,s=i.sfmc,h=i.svstb,c=i.svmdcmp,l=i.svloc,a=i.svattr,v=i.persbtncls,y=i.cstmuiobj,p=n.parseJsonString(u)||{},w=n.parseJsonString(y)||{};return n.objectAssign(n.parseJsonString(f)||{},{PredefinedType:p,Key:r,ComponentId:e,UnsavedFormCode:o,SavedFormCode:s,SavedLinkSameTab:!!h,MetaLocInfo:{MetadataLocationId:l,MetadataLocationAttr:a,MetaLocCompName:c},PersButtonClassName:v,CustomUIObj:w})}}function r(){if(n.singlePartner){var u=n.singlePartner.Mapping,f=n.singlePartner.SavedFormCode,e=n.singlePartner.SavedLinkSameTab,i=n.singlePartner.PredefinedType,o=i.Title,s=i.CollectionTagPath,r=i.PredefinedCollectionType,h=i.ItemType,c=i.APIItemType,l=n.singlePartner.Key,a=n.singlePartner.SourceAttr,v=n.singlePartner.ItemTagPath,y=n.singlePartner.AttachToElementSelector,p=n.singlePartner.AttachDelay,w=n.singlePartner.ComponentId,b=n.singlePartner.PersButtonClassName,k=n.singlePartner.CustomUIObj;u&&n.iterateThroughList(u.split(","),t);h&&(n.defaultItemType=h);l&&(n.partnerKey=l);r&&(n.defaultCollectionType=r,n.defaultCollectionId=Constants.PredefinedCollections[r]);o&&(n.defOrCustCollName=o);s&&(n.collTagPath=s);v&&(n.itemTagPath=v);w&&(n.compName=w);a&&(n.sourceAttribute=a);c&&(n.apiItemType=c);y&&(n.attachElementSelector=y,p&&(n.attachDelay=p));f&&(n.savedFormCode=f);e&&(n.savedLinkSameTab=e);n.apiItemType&&n.compName&&(n.urlParams=n.getUrlParamsForTelemetry(n.apiItemType,n.compName));b&&(n.persistentButtonClassName=b);k&&(n.customUIObj=k)}}function u(t,u){var f=t&&t.getAttribute("data-svcptid"),e;f&&!n.componentMap[f]&&(e=i(t),n.componentMap[f]=e,n.partnerCount++,n.partnerCount===1&&(n.singlePartner=e,r()));u&&u(t)}n.componentMap={};n.partnerCount=0;n.registerPartnerAndComponent=u}(SvCtrlV2||(SvCtrlV2={})),function(n){function nt(i){var u={ItmId:n.currentElementMid,CompName:n.currentCompName};t(r,y,u,MMInstUtils.getInstKData(i))}function tt(){var i={CompName:n.currentCompName,HvrSrc:g};t(f,"",i)}function it(){var i={CompName:n.currentCompName,HvrSrc:h};t(f,"",i)}function rt(i){var r={ColCount:i,CompName:n.currentCompName};t(u,a,r)}function ut(){var i={CompName:n.currentCompName};t(u,v,i)}function ft(r,u){var f={ColId:u,CollName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:w};t(i,"",f,MMInstUtils.getInstKData(r))}function et(r){var u={CompName:n.currentCompName,ClkSrc:b};t(i,"",u,MMInstUtils.getInstKData(r))}function ot(r,u){var f={ColId:u,ColName:n.localCollectionsMap[u],CompName:n.currentCompName,ClkSrc:p};t(i,"",f,MMInstUtils.getInstKData(r))}function st(r){var u={CompName:n.currentCompName,Clksrc:k};t(i,"",u,MMInstUtils.getInstKData(r))}function ht(r){var u={CompName:n.currentCompName,Clksrc:h};t(i,"",u,MMInstUtils.getInstKData(r))}function ct(i,u,f,e,s){var h={ColId:s,ItmId:u,CompName:n.currentCompName,ClkSrc:f,IsNewCol:e?"1":"0"};t(r,o,h,MMInstUtils.getInstKData(i))}function lt(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(e,o,r,MMInstUtils.getInstKData(i))}function at(i,u,f,e){var o={ColId:u,ItmId:f,CompName:n.currentCompName,ClkSrc:e};t(r,s,o,MMInstUtils.getInstKData(i))}function vt(i){var r={ItmId:n.currentElementMid,CompName:n.currentCompName};t(e,s,r,MMInstUtils.getInstKData(i))}function yt(i,r){var u={CompName:n.currentCompName,ErrorType:r};t(c,d,u,MMInstUtils.getInstKData(i))}function t(n,t,i,r){t===void 0&&(t="");i===void 0&&(i=null);r===void 0&&(r=null);MMInstUtils.logEvent(n,l,t,i,r)}var u="CI.Saves",f="CI.Hover",i="CI.SaveClick",r="CI.Success",e="CI.Failure",c="CI.SaveErr",l="SaveControl",o="Saved",s="Unsaved",a="GetCollections",v="GetCollFailed",y="ShowFlyout",p="LnkClk",w="ColLst",b="CrtNewBtn",k="ColExp",h="SvCtrlBtn",d="UIState",g="Flyout";n.logFlyoutShown=nt;n.logFlyoutHoverEvent=tt;n.logSvBtnHoverEvent=it;n.logGetCollectionsSucceeded=rt;n.logGetCollectionsFailed=ut;n.logCollLstClick=ft;n.logCreateButtonClick=et;n.logLinkClick=ot;n.logCollExpandClick=st;n.logSaveControlBtnClick=ht;n.logAddItemSucceeded=ct;n.logAddItemFailed=lt;n.logDeleteItemSucceeded=at;n.logDeleteItemFailed=vt;n.logErrorState=yt}(SvCtrlV2||(SvCtrlV2={})),function(n){function f(n){vt=n}function e(){return vt}function rt(t){n.removeElementClass(n.currentHoveredElement,n.CurrentElementCN);n.currentElementMid=null;n.currentElementCollId&&(sj_evt.fire("onCurrentCollIdUnset",n.currentElementCollId),n.currentElementCollId=null);t?v(t):(n.currentHoveredElement=null,n.currentElementTurl=null,n.currentElementMetadata=null)}function u(t,i){var r,u;return(i===void 0&&(i=n.sourceAttribute),!t)?null:(r=t.hasAttribute(i)?t:ri(t,i),!r)?null:(u=r.getAttribute(i),!u)?null:n.parseJsonString(u)}function sr(){if(n.currentElementTemp){var t=n.currentElementTemp;return n.currentElementTemp=null,t}}function dt(n){var r,t,i,u,f;if(n&&n.items){for(r=n.items,t=r.length-1;t>=0;t--)if(i=r[t],i&&i.content){if(u=i.content,!u)continue;if(f=ei(u),f)return f}return null}}function o(n){if(n){var t=n.mid,i=n.sid;return t||i}}function gt(i,f,e,s){var l,h,c,y;if(f===void 0&&(f=n.currentHoveredElement),s===void 0&&(s=n.sourceAttribute),l=1,h=f||n.currentHoveredElement,h){var a=i in Constants.PredefinedCollections,p=a?Constants.PredefinedCollections[i]:null,b=n.localCollectionsMap[i],v=function(t,r,u){return(u===void 0&&(u=null),!(t&&t[n.IsSuccessAttr]))?!1:(i&&(n.latestCollId=i),sj_evt.fire(n.CurrentCollIdSetEN,i),ut(),si(u,h,t,r,e,b,i,!1))},w=n.currentUrlParams;if(h.hasAttribute(n.SavesGenericItemDataAttr)&&typeof t.addEdgeGenericItem!==n.UndefinedString)t.addEdgeGenericItem(n.parseJsonString(h.getAttribute(n.SavesGenericItemDataAttr)),i,function(t){return v(t,!0,n.currentElementMid)},function(){return r(l)},n.currentCompName);else{if(c=u(h,s),!c){r(7);return}y=o(c);st(c)&&typeof t.addGenericItem!==n.UndefinedString?t.addGenericItem(w,c,n.itemSchema,n.itemTagPath,a?p:null,n.localCollectionsMap[i],i,n.partnerKey,null,function(n){return v(n,!0,y)},function(){return r(l)}):typeof t.addNonGenericItem!==n.UndefinedString&&t.addNonGenericItem(w,c,n.defaultItemType,n.itemSchema,i,a?p:null,n.localCollectionsMap[i],function(n){return v(n,!1,y)},function(){return r(l)})}}}function ni(i,f,e,s){var a=1,c=f||n.currentHoveredElement,l,v,h,w,p;if(c)if(l=function(t,r,u){var o,s,f;return(u===void 0&&(u=null),!(t&&t[n.IsSuccessAttr]))?!1:(f=(s=(o=t.targetCollectionOperationStatus)===null||o===void 0?void 0:o.collection)===null||s===void 0?void 0:s.id,f)?(y(f,i),n.latestCollId=f,sj_evt.fire(n.CollRegisterEN,!0,f,i,n.currentElementTurl,null,!0),e&&e(t),ut(),si(u,c,t,r,"Flyt",i,f,!0)):!1},v=n.currentUrlParams,c.hasAttribute(n.SavesGenericItemDataAttr)&&typeof t.addEdgeGenericItemToNewColl!==n.UndefinedString)t.addEdgeGenericItemToNewColl(n.parseJsonString(c.getAttribute(n.SavesGenericItemDataAttr)),i,function(n){return l(n,!0)},function(){return r(a)},n.currentCompName);else{if(h=u(c),w=function(){r(7);s()},!h){w();return}p=o(h);st(h)&&typeof t.addGenericItem!==n.UndefinedString?t.addGenericItem(v,h,n.itemSchema,n.itemTagPath,null,i,null,n.partnerKey,n.collTagPath,function(n){return l(n,!0,p)},function(){return r(a)}):i&&typeof t.addNonGenericItem!==n.UndefinedString&&t.addNonGenericItem(v,h,n.defaultItemType,n.itemSchema,null,null,i,function(n){return l(n,!1,p)},function(){return r(a)})}}function ti(i,u,f){var a=2,o=f||n.currentHoveredElement,s,e,h,c,l;o&&(s=n.currentElementMid,e=n.localSavedItemsMap[s],e)&&(h=function(t){return n.latestCollId=i,sj_evt.fire("onCurrentCollIdUnset",i),ut(),vr(s,o,t,u,e.cid||null,i)},c=n.currentUrlParams,(o.hasAttribute(n.SavesGenericItemDataAttr)||n.currentElementMetadata&&st(n.currentElementMetadata))&&typeof t.deleteGenericItem!==n.UndefinedString?t.deleteGenericItem(c,e.cid,n.kctColls[i]||i,h,function(){return r(a)}):typeof t.deleteNonGenericItem!==n.UndefinedString&&(l=i in Constants.PredefinedCollections,t.deleteNonGenericItem(c,l?Constants.PredefinedCollections[i]:"",l?"":i,e.cid,n.defaultItemType,h,function(){return r(a)})))}function hr(t,i,r,u){var f=u||n.currentHoveredElement,e;if(f){if(n.logSaveControlBtnClick(f),sj_evt.fire("onSaveInProgress",f),t==n.CustomCollDummyId){ni(n.defOrCustCollName,n.currentHoveredElement,function(){n.removeCollectionFromPicker(n.CustomCollDummyId)});return}e=n.elementHasClass(f,n.SavedCN)||n.elementHasClass(n.hoverContainerSub,n.SavedCN);!e&&(n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentElementMid])&&(e=!0);e?r&&ti(t,i):gt(t,f,i)}}function ut(){i&&i.broadcastMessage(i.BCActionMessage)}function ft(t,i,r,u,f){n.standalone&&sj_evt.fire(n.scEngagementEN,t,i,r,u,f)}function ii(t){var i,r,u;if(l)for(i in n.localSavedItemsMap)if(r=n.localSavedItemsMap[i],r.rawItem&&(u=r.rawItem,n.isDataPointingToSameItem(t,u)))return i;return null}function v(t,i,r,f){var h,c,e,l,s;i===void 0&&(i=n.sourceAttribute);r===void 0&&(r=n.urlParams);f===void 0&&(f=n.compName);n.addElementClass(t,n.CurrentElementCN);n.currentHoveredElement=t;e=u(t,i)||u(t,n.SavesGenericItemDataAttr);e&&(n.currentElementMetadata=e,n.currentElementMid=o(e)||ii(e),n.currentElementTurl=e.turl,n.currentElementTurl||(l=(c=(h=e.ThumbnailInfo)===null||h===void 0?void 0:h[0])===null||c===void 0?void 0:c.Thumbnail,l&&(n.currentElementTurl=l)),s={},n.currentElementMid?((n.localSavedItemsMap===null||n.localSavedItemsMap===void 0?void 0:n.localSavedItemsMap[n.currentElementMid])?(n.currentElementCollId=n.localSavedItemsMap[n.currentElementMid].lastCollection,n.currentElementCollId&&sj_evt.fire(n.CurrentCollIdSetEN,n.currentElementCollId),s=n.localSavedItemsMap[n.currentElementMid].collections,n.addElementClass(t,n.SavedCN),n.addElementClass(n.hoverContainerSub,n.SavedCN)):n.removeElementClass(n.hoverContainerSub,n.SavedCN),sj_evt.fire(n.HoverElementSetEN,s)):(n.removeElementClass(n.hoverContainerSub,n.SavedCN),n.removeElementClass(t,n.SavedCN),sj_evt.fire(n.HoverElementSetEN,s)));n.currentUrlParams=r;n.currentCompName=f}function et(t){var i,r;return t?(i=n.defaultItemType in n.TypeToAttributeMap?n.TypeToAttributeMap[n.defaultItemType]:null,!i)?t:(r=n.defaultItemType+":"+i+"=",(t.indexOf(r)!==0?r:"")+t):null}function ri(n,t){return n?_qs("["+t+"]",n):null}function s(t){var r=ri(n.containerElement,n.sourceAttribute+'*="'+t+'"'),i;if(!r)return null;for(i=r;!n.isSavableEntity(i)&&i[n.ParentElementAttr];)i=i[n.ParentElementAttr];return n.isSavableEntity(i)?i:r}function h(t,i,r,u,f,e){if(t&&i){if(!(i in n.localSavedItemsMap)){n.elementHasClass(t,n.SavedCN)&&n.removeElementClass(t,n.SavedCN);return}n.addElementClass(t,n.SavedCN);r&&(t&&sj_evt.fire("Saved",t),n.logAddItemSucceeded(t,i,u,f,e))}}function ot(t,i,r,u,f){t&&i&&(i in n.localSavedItemsMap||n.removeElementClass(t,n.SavedCN),r&&(t&&sj_evt.fire("Unsaved",t),n.logDeleteItemSucceeded(t,f||g,i,u)))}function ui(t,i,r,u,f){var e,o;t&&(t in n.localSavedItemsMap?(u&&n.localSavedItemsMap[t].lastCollection||(n.localSavedItemsMap[t].lastCollection=r),n.localSavedItemsMap[t].collections[r]||(n.localSavedItemsMap[t].collections[r]=!0,n.localSavedItemsMap[t].numCollections++),u?n.localSavedItemsMap[t].collectionQueue.unshift(r):n.localSavedItemsMap[t].collectionQueue.push(r)):(o={cid:f?i:et(i),rawItem:f?f:null,collections:(e={},e[r]=!0,e),lastCollection:r,collectionQueue:[r],numCollections:1},n.localSavedItemsMap[t]=o))}function fi(t,i){if(t&&n.localSavedItemsMap[t])if(g=i,n.localSavedItemsMap[t].numCollections===1)delete n.localSavedItemsMap[t],n.currentElementMid===t&&(n.currentElementCollId=null);else{delete n.localSavedItemsMap[t].collections[i];n.localSavedItemsMap[t].numCollections--;var r=n.localSavedItemsMap[t].collectionQueue.indexOf(i);r>-1&&(n.localSavedItemsMap[t].collectionQueue.splice(r,1),n.localSavedItemsMap[t].lastCollection=n.localSavedItemsMap[t].collectionQueue.slice(-1)[0],n.currentElementMid===t&&(n.currentElementCollId=n.localSavedItemsMap[t].lastCollection))}}function cr(t,i){t&&(n.switchElementToErrorClass(t),sj_evt.fire(n.SaveControlErrorEN,i))}function ei(n){var t,i;return n.thumbnailUrl||((i=(t=n.thumbnails)===null||t===void 0?void 0:t[0])===null||i===void 0?void 0:i.thumbnailUrl)}function oi(t,i,r,u){n.localCollectionsCidMap[t]||(n.localCollectionsCidMap[t]=[]);n.localCollectionsCidMap[t].indexOf(i)<=-1&&(u?n.localCollectionsCidMap[t].push(i):n.localCollectionsCidMap[t].unshift(i));n.cidToThumbnailUrlMap[i]||(n.cidToThumbnailUrlMap[i]=r)}function lr(t,i){var r,u;if(n.localCollectionsCidMap[t])return(u=n.localCollectionsCidMap[t].indexOf(i),u<=-1)?void 0:(n.localCollectionsCidMap[t].splice(u,1),((r=n.localCollectionsCidMap[t])===null||r===void 0?void 0:r[0])||null)}function ar(t,i){var r,f;return t?(r=n.parseJsonString(t.getAttribute(n.SavesGenericItemDataAttr)),r||(r=u(t,n.sourceAttribute)),!r)?null:(f={url:r.ClickThroughUrl,customData:r.CustomData,domain:r.FriendlyDomainName,itemTagPath:r.ItemTagPath,title:r.Title,_type:"GenericItem"},{collectionItemId:i,content:f,itemtype:"Generic"}):null}function si(t,i,r,u,f,e,o,c){var y=r.targetCollectionOperationStatus,p,l,w,b,nt,tt;if(!(y&&y[n.IsSuccessAttr]))return!1;try{var k=y,d=k.itemOperationStatuses,it=n.CollectionAttr,v=k[it];if(!(d&&v&&v.id))return!1;var rt=d,g=rt[0],ut=n.IsSuccessAttr,ot=g[ut],st=n.CollectionItemIdAttr,a=g.item[st];return ot?(p=o in Constants.PredefinedCollections,l=p?o:v.id,n.latestCollId=l,p&&(n.kctColls[o]=v.id),t||n.currentElementMid!==null||a===null||(w=a.substring(a.indexOf(":")+1),t=w,n.currentElementMid=w),!t&&n.currentElementMid&&(t=n.currentElementMid),b=u?a:et(a),oi(l,b,n.currentElementTurl,!1),n.localCollectionsMap[l]&&sj_evt.fire("onChangeCollThumbnail",l,n.currentElementTurl),nt=t?n.localSavedItemsMap[t]:!1,tt=u?ar(i,a):null,ui(t,b,l,!1,tt),n.localSavedItemsMap[t]&&ft(1,0,c?1:0,n.localSavedItemsMap[t].numCollections),i)?(h(i,t,!0,f,c,l),sj_evt.fire(n.UpdateHoverBoxEN,l,n.localCollectionsMap[l],t&&n.localSavedItemsMap[t].numCollections||1),n.isSavableEntity(i)||h(s(t),t,!1),hi(n.SaveAddEN,r,t,i,!nt)):!1:!1}catch(ht){return!1}}function vr(t,i,r,u,f,e){var h,o;return(r&&r[n.IsSuccessAttr])?(r.collectionId=e,fi(t,e),ft(0,1,0,n.localSavedItemsMap[t]?n.localSavedItemsMap[t].numCollections:0),i)?(ot(i,t,!0,u,e),h=lr(e,f),sj_evt.fire("onChangeCollThumbnail",e,h?n.cidToThumbnailUrlMap[h]:null),o=!n.localSavedItemsMap[t],o&&!n.isSavableEntity(i)&&ot(s(t),t,!1),sj_evt.fire(n.UpdateHoverBoxEN,e,n.localCollectionsMap[e],o?0:n.localSavedItemsMap[t].numCollections),hi(n.SaveDelEN,r,t,i,o)):!1:!1}function hi(t,i,r,u,f){if(u){if(n.removeInProgress(u),n.currentHoveredElement===u){n.removeElementClass(n.ctrl,n.GetErrCN);switch(t){case n.SaveAddEN:n.addElementClass(n.hoverContainerSub,n.SavedCN);break;case n.SaveDelEN:f&&n.removeElementClass(n.hoverContainerSub,n.SavedCN)}n.removeInProgress(n.hoverContainerSub)}sj_evt.fire(t,i,r,u,f,typeof n.metaLocElement!==n.UndefinedString&&n.metaLocElement===u)}return g=null,!0}function st(t,i){return i===void 0&&(i=n.defaultItemType),!("mid"in t)&&i!=="recipe"}function r(t){n.currentHoveredElement&&(cr(n.currentHoveredElement,t),t==1?n.logAddItemFailed(n.currentHoveredElement):t==2&&n.logDeleteItemFailed(n.currentHoveredElement))}function yr(){n.logGetCollectionsFailed();n.addElementClass(n.ctrl,n.GetErrCN);sj_evt.fire(n.SaveControlErrorEN,3);nt=!1}function pr(t){n.logGetCollectionsSucceeded(t)}function wr(n){if(!(n&&n.content&&n.itemType))return null;var t=n.content,i=n.itemType;switch(i){case"Image":return t.imageId;case"Video":return t.videoId;case"Generic":return t.contentId;default:return null}}function br(t){if(!t)return null;var u=t&&t[n.CollectionItemIdAttr],i=u?decodeURIComponent(u):"",r=wr(t);return r||(r=/^[a-z]+:[a-z]+=/.test(i)?i.substring(i.indexOf("=")+1):i.replace("/"+n.partnerKey+"/:","")),{contentId:r,collectionItemId:i}}function y(t,i){n.localCollectionsMap[t]=i;n.localCollectionNames[i]=1}function kr(t){if(!(t.length<=0)){var r=t.sort(function(n,t){return n.dateModified>t.dateModified?-1:1}),i=r[0];n.latestCollId=!i.knownCollectionType?i.id:Constants.PredefinedCollections[i.knownCollectionType]}}function dr(t){var i,e;if(t){var u=t.collectionPage,f=t.id,r=t.knownCollectionType;(r&&(n.kctColls[Constants.PredefinedCollections[r]]=f),i=!r?f:Constants.PredefinedCollections[r],n.localCollectionsMap[i]||lu(t),u&&u.items)&&(e=u.items,n.iterateThroughList(e,function(t){var f;if(t){var e=br(t),u=e.collectionItemId,r=e.contentId;r&&u&&(t.content&&oi(i,u,ei(t.content),!0),ui(r,u,i,!0,t),f=s(r),f)&&(h(f,r),sj_evt.fire(n.UpdateHoverBoxEN,i,n.localCollectionsMap[i],n.localSavedItemsMap[r].numCollections))}}))}}function gr(t){var i,r;return(t&&t.collections)?(i=t.collections,i=i.reverse(),r=(i===null||i===void 0?void 0:i.length)||0,pr(r),n.iterateThroughList(i,dr),kr(i),sj_evt.fire("onSaveGet",t),l||(l=!0,a&&(v(a),a=null)),n.defaultCollectionType&&!n.localCollectionsMap[n.defaultCollectionId]&&(y(n.defaultCollectionId,n.defOrCustCollName),n.latestCollId||(n.latestCollId=n.defaultCollectionId),sj_evt.fire(n.CollRegisterEN,!1,n.defaultCollectionId,n.defOrCustCollName,null,n.defaultCollectionType)),!n.defaultCollectionType&&n.collTagPath&&n.defOrCustCollName&&!n.isCollectionExists(n.defOrCustCollName)&&(n.latestCollId=n.CustomCollDummyId,sj_evt.fire(n.CollRegisterEN,!1,n.CustomCollDummyId,n.defOrCustCollName)),n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner),sj_evt.fire("onCollectionsGotten"),!0):!1}function nu(t,i){n.hoverContainer&&n.hoverContainer.style.setProperty(t,i)}function ci(t){n.hoverContainerSub&&n.removeElementClass(n.hoverContainerSub,t)}function ht(t){n.hoverContainer&&t&&n.iterateOverObject(t,nu)}function li(t){n.hoverContainer&&ht({display:t})}function tu(n){kt=new Date;tt===!1&&(tt=!0,setTimeout(function(){return ai(n)},it))}function ai(t){var u=new Date,i,r;u.getTime()-kt.getTime()<it?setTimeout(function(){return ai(t)},it):(tt=!1,i=_qs("."+n.persistentButtonClassName,_d.body),(t===null||t===void 0?void 0:t.type)==="resize"&&i&&n.elementHasClass(n.hoverContainerSub,"b_scpers")?(r=n.getClientRect(i),ht({top:r.top+n.PixelUnit,left:r.left+n.PixelUnit})):c())}function c(t){var r=t||n.currentHoveredElement,i;if(n.hoverContainer&&r){if(f(!0),au(),i=n.getClientRect(r),!i){f(!1);return}var u=i.top,e=i.bottom,o=i.left,s=i.width,h=i.height,c=e>_w.innerHeight?_w.innerHeight-u:h;ht({width:s+n.PixelUnit,height:c+n.PixelUnit,top:u+wt+n.PixelUnit,left:o+pt+n.PixelUnit});f(!1)}}function vi(){n.hoverContainer&&li("block")}function p(){n.hoverContainer&&(li("none"),sj_evt.fire("onHoverContainerHide"))}function iu(t){var i=n.currentHoveredElement;i&&n.hoverContainerSub&&(n.elementHasClass(i,t)?n.addElementClass(n.hoverContainerSub,t):ci(t))}function ru(){if(!e()){var t=yi(null);t&&(rt(t),n.hoverContainer&&(c(),vi(),n.removeElementClass(n.hoverContainerSub,"b_scpers"),n.iterateThroughList(n.RemovableCN,iu)),sj_evt.fire(n.ControlAppendedEN))}}function uu(t){if(!e()){var i=t[n.RelatedTargetAttr];if(i||p(),i&&n.hoverContainer){if(n.elementContains(n.ctrl,i))return;n.isElementInSpaceOfAnother(i,n.hoverContainer)||p()}}}function yi(n){b&&sb_ct(b);var t=yt;return yt=n,n&&(b=sb_st(ru,or*2)),t}function fu(t){if(!e()){var i=t[n.CurrentTargetAttr];n.currentFocusTarget=t.target;i&&n.isSavableEntity(i)?yi(i):sj_pd(t)}}function eu(t){var i,r,f,u,o;if(!e()){if(i=t[n.CurrentTargetAttr],r=t[n.RelatedTargetAttr],!r){if(f=t[n.TargetAttr],t.type!=="mouseleave"&&n.elementContains(i,f))return;p();return}if(!n.elementContains(n.ctrl,r)&&n.isSavableEntity(i)&&!n.elementContains(i,r)){for(u=r;!n.isSavableEntity(u)&&u[n.ParentElementAttr];)u=u[n.ParentElementAttr];if(o=n.isSavableEntity(u),t.type==="focusout"&&!n.elementContains(i,r)&&!n.shiftKeyDown&&n.tabKeyDown&&o){n.nextFocusable=r;n.ctrlBtn.focus();sj_evt.fire(n.SaveButtonFocusEN);n.tabKeyDown=!1;return}n.hoverContainer&&p();n.iterateThroughList(n.RemovableCN,ci);n.iterateThroughList([n.HoverCN,n.FocusCN,n.SaveCtrlHoveredCN,n.CurrentElementCN],function(t){n.removeElementClass(i,t)});n.currentHoveredElement===i&&(rt(),n.currentFocusTarget==null)}}}function pi(t){t&&(n.addInListeners(t,fu),n.addOutListeners(t,eu),n.isSavableEntity(t)&&bi(t))}function w(n,t,i){return(i===void 0&&(i=""),n&&n.children&&t)?n.querySelectorAll("."+t+i):[]}function wi(t){return t?w(t,n.SavableEntityCN):[]}function ct(t){if(t){if(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.bclist){var i=n.ctrl.dataset.bclist.toLowerCase().split(",");if((i===null||i===void 0?void 0:i.indexOf(n.compName===null||n.compName===void 0?void 0:n.compName.toLowerCase()))>-1)return}n.isSavableEntity(t)?pi(t):n.iterateThroughList(wi(t),pi)}}function bi(n){if(n){var t=u(n);t&&h(n,o(t)||ii(t))}}function ou(t){var i=t;i&&(i.type==="attributes"&&i.target&&n.iterateThroughList(wi(i.target),function(n){ct(n);bi(n)}),n.ctrl&&i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,ct))}function su(i){n.partnerCount!==1||nt||(n.containerElement=i,typeof t.getCollections!==n.UndefinedString&&(t.getCollections(n.urlParams,gr,yr),nt=!0));d.observe(i,at);n.ctrl&&ct(i)}function hu(t){for(var i=t,u={scroll:1,overlay:1,auto:1},r;i&&i.parentElement&&i!==(_d===null||_d===void 0?void 0:_d.body);){if(i.hasAttribute(n.ScrollBindDataAttr))break;r=_w===null||_w===void 0?void 0:_w.getComputedStyle(i);(r.overflow in u||r.overflowX in u||r.overflowY in u)&&(n.addListenerToElement(i,"scroll",function(){c()}),i.setAttribute(n.ScrollBindDataAttr,"1"));i=i.parentElement}}function ki(t){n.registerPartnerAndComponent(t,su);(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.cstmui)&&yu();hu(t)}function di(t){var r,i,u,f;if(t&&(n.elementHasClass(t,n.SaveCtrlContainerCN)?t.dataset.svcptid&&ki(t):n.elementHasClass(t,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner),r=t.children,r))for(i=0,u=r;i<u.length;i++)f=u[i],di(f)}function cu(t){var i=t;i&&(i.addedNodes&&i.addedNodes.length>0&&n.iterateThroughList(i.addedNodes,di),i.removedNodes&&i.removedNodes.length>0&&n.iterateThroughList(i.removedNodes,function(t){n.elementHasClass(t,n.persistentButtonClassName)&&sj_evt.fire(n.DeregisterPersBtnEN)}),i.attributeName&&i.target&&n.elementHasClass(i.target,n.persistentButtonClassName)&&n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner))}function lt(t){t&&n.iterateThroughList(t,ki)}function gi(t){return new MutationObserver(function(i){return n.iterateThroughList(i,t)})}function nr(n){var t=n[1],i=n[2],u,r;t&&i&&(u=i&&et(i),u)&&(r=s(t),r&&h(r,t,!1))}function tr(n){var t=n[1],r=n[2],i;t&&(i=s(t),fi(t,r),i&&ot(i,t,!1))}function lu(t,i){var f,r;i===void 0&&(i=!1);var h=t.id,e=t.title,o=t.collectionPage,s=t.knownCollectionType,u=s?Constants.PredefinedCollections[s]:h;!n.localCollectionsMap[u]&&e&&(y(u,e),r=null,o&&((f=o.items)===null||f===void 0?void 0:f.length)&&(r=dt(o),r&&sj_evt.fire("onChangeCollThumbnail",u,r)),sj_evt.fire(n.CollRegisterEN,i,u,e,r,s||null))}function au(){pt=_w.scrollX||_w.pageXOffset;wt=_w.scrollY||_w.pageYOffset}function ir(){(n.flyoutContainer===null||n.flyoutContainer===void 0?void 0:n.flyoutContainer.dataset.ebc)&&typeof CollChannel.CollectionsBroadcastChannel!="undefined"&&(i=new CollChannel.CollectionsBroadcastChannel(pu,null,null,!1),i===null||i===void 0?void 0:i.initialize())}function rr(t){var i=t[1],r=t[2],u=t[3],f=t[4],e=t[5];v(r,u,f,e);c(i);vi();n.addElementClass(n.hoverContainerSub,"b_scpers");sj_evt.fire(n.ControlAppendedEN)}function vu(){var t=_d.querySelector(":root"),i,r;t&&(t.style.setProperty(n.IcnsBGColorCss,n.SavePromClrCss),t.style.setProperty(n.IcnLblTxtClrCss,n.SavePromTxtClrCss),i=getComputedStyle(t).getPropertyValue(n.SavedPromIcnCss),t.style.setProperty(n.SavedIcnCss,i),r=getComputedStyle(t).getPropertyValue(n.UnsavedPromIcnCss),t.style.setProperty(n.UnsavedIcnCss,r))}function yu(){n.customUIObj&&n.flyoutContainer&&(n.customUIObj.BGColor&&n.flyoutContainer.style.setProperty(n.FlyoutBGClrCss,n.customUIObj.BGColor),n.customUIObj.TextColor&&n.flyoutContainer.style.setProperty(n.FlyoutTxtClrCss,n.customUIObj.TextColor),n.customUIObj.LinkColor&&n.flyoutContainer.style.setProperty(n.FlyoutLnkClrCss,n.customUIObj.LinkColor))}function pu(){return}function ur(t){var i=t[1];lt(w(_d.body,n.SaveCtrlContainerCN));l?v(i):a=i}function fr(){lt(w(_d.body,n.SaveCtrlContainerCN));n.singlePartner&&sj_evt.fire(n.PartnerRegisterEN,n.singlePartner)}function er(){sj_evt.unbind(n.FavAddEN,nr);sj_evt.unbind(n.FavDeleteEN,tr);sj_evt.unbind("ajax.unload",er);sj_evt.unbind(n.PersButtonInteractEN,rr);sj_evt.unbind(n.CollBCLoadedEN,ir);sj_evt.unbind(n.CurrentElementSetEN,ur);sj_evt.unbind(n.UpdateSaveStateEN,fr);_d.body.removeChild(n.hoverContainer);k.disconnect();d.disconnect();i===null||i===void 0?void 0:i.close()}function wu(){sj_evt.bind(n.FavDeleteEN,tr);sj_evt.bind(n.FavAddEN,nr);sj_evt.bind(n.PersButtonInteractEN,rr);sj_evt.bind("ajax.unload",er);sj_evt.bind(n.CurrentElementSetEN,ur,!0);sj_evt.bind(n.UpdateSaveStateEN,fr,!0);sj_evt.bind(n.CollBCLoadedEN,ir,!0)}function bu(){n.ctrl=_ge("svctrl");n.ctrl&&(f(!1),n.addListenerToElement(n.ctrl,"mousedown",sj_sp));n.ctrlBtn=_ge("svctrlbtn");n.hoverContainer=_ge("svhvr");n.hoverContainerSub=_ge("svhvrsub");n.hoverContainer&&(_d.body.insertBefore(n.hoverContainer,_d.body.firstChild),n.addOutListeners(n.hoverContainer,uu));n.localSavedItemsMap={};n.localCollectionsMap={};n.localCollectionsCidMap={};n.cidToThumbnailUrlMap={};n.localCollectionNames={};n.latestCollId=null;n.currentElementCollId=null;n.currentElementMid=null;n.partners=[];d=gi(ou);k=gi(cu);k.observe(_d.body,at);n.flyoutContainer=_ge("svflytc");n.flyoutContainer&&n.flyoutContainer.hasAttribute("data-svlne")&&(n.standalone=!!n.flyoutContainer.getAttribute("data-svlne"));n.standalone||lt(w(_d.body,n.SaveCtrlContainerCN));wu();n.addListenerToElement(_w,n.ScrollEvent,c);n.addListenerToElement(_w,n.ResizeEvent,tu);bt=n.debounce(function(){n.tabKeyDown=!1},1e3);_w.addEventListener("keydown",function(t){!n.shiftKeyDown&&t.shiftKey?n.shiftKeyDown=!0:n.tabKeyDown||t.key!="Tab"||(n.tabKeyDown=!0)});_w.addEventListener("keyup",function(t){!t.shiftKey&&n.shiftKeyDown?n.shiftKeyDown=!1:n.tabKeyDown&&t.key=="Tab"&&bt()});(n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.isprom)&&vu()}var t=MySavesAPIUtils;n.containerElement=null;n.shiftKeyDown=!1;n.tabKeyDown=!1;n.kctColls={};var at={childList:!0,subtree:!0,attributes:!0},vt,l=!1,a=null,b,k,d,g,yt,or=0,pt=0,wt=0,i,nt=!1,bt=null,kt,tt=!1,it=500;n.setKeepFlyoutActive=f;n.getKeepFlyoutActive=e;n.clearCurrentHoveredElement=rt;n.metadataFromElement=u;n.clearTempCurrentElement=sr;n.getThumbnailUrlFromCollectionPage=dt;n.getMetadataId=o;n.addToCollection=gt;n.addToNewCollection=ni;n.removeFromCollection=ti;n.handleSaveClick=hr;n.fireSCEngagementEvent=ft;n.addCollectionName=y;bu()}(SvCtrlV2||(SvCtrlV2={})),function(n){function wt(t){if(i){t||(t=n.currentElementMid);var r=t&&n.localSavedItemsMap[t],u=r?r.lastCollection:n.latestCollId,f=u&&n.localCollectionsMap[u]||n.defOrCustCollName;at(u,f,r?r.numCollections:0)}}function ct(t,i){if(t&&ot!==t){n.removeElementClass(ot,"b_sclbl");n.addElementClass(t,"b_sclbl");ot=t;n.removeElementClass(pt,n.SublabelActiveCN);var r=t.querySelector(i?"onsvd":"onusvd");n.addElementClass(r,n.SublabelActiveCN);pt=r}}function si(t){sj_sp(t);var i=t.target.value.trim(),r=n.isCollectionExists(i);w.setAttribute("aria-disabled",i&&!r?"false":"true");r?n.addElementClass(c,n.ErrDispCN):n.elementHasClass(c,n.ErrDispCN)&&n.removeElementClass(c,n.ErrDispCN)}function bt(t){var i,r=t[1];at(r,n.localCollectionsMap[r],n.currentElementMid&&((i=n.localSavedItemsMap[n.currentElementMid])===null||i===void 0?void 0:i.numCollections))}function hi(t){var i=t[1];i==5?(n.removeElementClass(ut,n.errStateInvisibleCN),n.addElementClass(ut,n.errStateVisibleCN)):d&&(e.textContent=d[i],n.removeElementClass(e,n.errStateInvisibleCN),n.addElementClass(e,n.errStateVisibleCN));n.logErrorState(n.currentHoveredElement,n.UiErrorStates[i]);n.fireSCEngagementEvent(0,0,0,n.currentElementMid&&n.localSavedItemsMap[n.currentElementMid]?n.localSavedItemsMap[n.currentElementMid].numCollections:0,n.UiErrorStates[i]);y(f)}function ci(t){var f=t[0],r=t[1],u=t[2],i=t[3];i===0?n.removeElementClass(n.hoverContainerSub,n.SavedCN):n.addElementClass(n.hoverContainerSub,n.SavedCN);at(r,u,i)}function li(){var s;if(n.ctrl&&(s=n.ctrl.dataset,s)){var v=s.dly,p=s.sfmc,y=s.svctrlv3;v&&(st=parseInt(v,10));n.savedFormCode||(n.savedFormCode=p);y&&(g=y)}h=_ge("svctrlinlineform");it=_ge("svctrlnewint");w=_ge("svctrlinlineformcreate");l=_ge("svctrlhvr");t||(t=_ge("svflytc"));i=_ge("svctrllnk");ft=_ge("sccolltxt");yt=i.getAttribute("href");et=_ge("svctrlhvrnum");f=_ge("svctrlerr");e=_ge("svctrlerrtxt");r=_ge("svctrlhvrbtn");rt=_ge("svctrllstw");b=_ge("svctrlhvrpnl");ut=_ge("svctrlmsmtcherrtxt");k=_ge("svctrlmsmtchlnk");a=_ge("svctrlhvrpnlbtn");c=_ge("svctrlinlineformerrdup");h&&(u=_ge("svctrlinlineformname"),n.addClickListener(_ge("svctrlinlineformback"),lt),n.addClickListener(w,ni),u&&(n.addEnterKeyListener(u,ni),n.addListenerToElement(u,"keyup",si)));i&&n.isAnchorElement(i)&&n.addClickListener(i,fi);k&&n.isAnchorElement(k)&&n.addClickListener(k,fi);t&&(n.standalone||(n.addInListeners(t,n.logFlyoutHoverEvent),n.addOutListeners(t,gi)),g||(n.addInListeners(n.ctrlBtn,tr),n.addOutListeners(n.ctrlBtn,ir)),l&&n.addClickListener(r,ki),n.addClickListener(_ge("svctrltri"),rr,!1),t.hasAttribute(n.SaveErrorMapAttr)&&(d=n.parseJsonString(t.getAttribute(n.SaveErrorMapAttr))));sj_evt.bind(n.ControlAppendedEN,ur);sj_evt.bind("onSaveInProgress",wi);sj_evt.bind(n.SaveAddEN,yi);sj_evt.bind(n.SaveDelEN,pi);sj_evt.bind("onHoverContainerHide",nt);sj_evt.bind(n.CurrentCollIdSetEN,bt);sj_evt.bind(n.UpdateHoverBoxEN,ci);sj_evt.bind(n.SaveButtonClickEN,o);n.standalone||sj_evt.bind(n.CollListExpandEN,ii);sj_evt.bind(n.SaveControlErrorEN,hi);n.standalone&&(sj_evt.bind(n.CollectionsGottenEN,vi),sj_evt.bind(n.HostSavesControlClickedEN,ai));sj_evt.bind(n.SaveButtonFocusEN,bi)}function ai(t){var i=t[0],r=t[1];i==n.HostSavesControlClickedEN&&oi(null,null,r)}function vi(t){var i=t[0];i==n.CollectionsGottenEN&&s!=f&&(bt([null,n.currentElementCollId||n.latestCollId]),y(l),ri())}function kt(t){var i;wt(t);(!g||n.isCreateDialogShowing)&&o();gt((i=n.localSavedItemsMap[t])===null||i===void 0?void 0:i.numCollections)}function yi(t){var i=t[3];n.currentHoveredElement===i&&(kt(n.currentElementMid),n.addElementClass(n.hoverContainerSub,n.SavedCN))}function pi(t){var i=t[3],r=t[4];n.currentHoveredElement===i&&(kt(n.currentElementMid),r&&n.removeElementClass(n.hoverContainerSub,n.SavedCN))}function dt(){n.removeElementClass(f.querySelector("."+n.SublabelActiveCN),n.SublabelActiveCN)}function wi(t){var i=t[1],r=t[2];n.standalone||(dt(),n.currentHoveredElement===i&&ct(_ge("svctrlhvrpnling"),r))}function bi(){t&&o()}function lt(){r&&h&&(n.removeElementClass(b,n.DeactivateCN),n.removeElementClass(rt,n.DeactivateCN),n.removeElementClass(h,n.FlyoutActiveCN),n.removeElementClass(r,n.DeactivateCN),n.addElementClass(r,n.FlyoutActiveCN),n.setKeepFlyoutActive(!1),u.value="",u.disabled=!0,r.setAttribute("tabindex","0"),i.setAttribute("tabindex","0"),a&&a.setAttribute("tabindex","0"),n.collectionList&&n.collectionList.setAttribute("tabindex","0"),n.isCreateDialogShowing=!1)}function ki(){(n.clearTempCurrentElement(),r&&h)&&(n.addElementClass(b,n.DeactivateCN),n.addElementClass(rt,n.DeactivateCN),n.addElementClass(r,n.DeactivateCN),n.addElementClass(h,n.FlyoutActiveCN),n.removeElementClass(r,n.FlyoutActiveCN),n.setKeepFlyoutActive(!0),u.value="",u.disabled=!1,u.focus(),n.removeElementClass(c,n.ErrDispCN),w.setAttribute("aria-disabled","true"),r.setAttribute("tabindex","-1"),i.setAttribute("tabindex","-1"),a&&a.setAttribute("tabindex","-1"),n.collectionList&&n.collectionList.setAttribute("tabindex","-1"),n.isCreateDialogShowing=!0)}function gt(n){if(et&&n!==undefined&&n!==null){var t=n-1;et.textContent=t>0?"+"+t:""}}function at(r,u,f){var o,s=n.standalone&&((o=t===null||t===void 0?void 0:t.dataset)===null||o===void 0?void 0:o.htc)&&(!f||f==0),e;(s?(i.textContent=t.dataset.htc,tt=""):(i.textContent=u,tt=r,g&&ft&&(ft.textContent=u)),n.isAnchorElement(i))&&(e=yt,n.savedFormCode&&(e+="&FORM="+n.savedFormCode),s||(e+="&collId="+r),i.setAttribute("href",e),n.savedLinkSameTab&&i.hasAttribute(n.TargetAttr)?i.removeAttribute(n.TargetAttr):i.setAttribute(n.TargetAttr,"_blank"),gt(f))}function ni(){var i,t;if(n.logCreateButtonClick(n.currentHoveredElement),t=(i=u.value)===null||i===void 0?void 0:i.trim(),t){if(n.isCollectionExists(t)){n.addElementClass(c,n.ErrDispCN);return}n.currentElementTemp=n.currentHoveredElement;y(it);n.addToNewCollection(t,n.currentElementTemp,null,lt)}}function di(t){n.nextFocusable.focus();n.nextFocusable=null;sj_pd(t)}function gi(i){if(!n.getKeepFlyoutActive()){var r=i.relatedTarget;if(i.type==="focusout"&&!n.elementContains(t,r)&&n.nextFocusable){di(i);return}if(r){if(n.isElementInSpaceOfAnother(t,r))return;if(n.elementContains(n.ctrl,r))return;if(n.isElementInSpaceOfAnother(n.ctrl,r))return}nt();n.clearCurrentHoveredElement()}}function ti(){v&&(sb_ct(v),v=null)}function ii(){var i,r,a,s,h,c,v,f;if(t&&(n.removeElementClass(n.ctrl,n.NarrowImageCN),t.style.removeProperty("left"),t.style.removeProperty("right"),t.style.removeProperty("bottom"),n.removeElementClass(n.ctrl,n.NarrowImageRightCN),n.removeElementClass(n.ctrl,n.NarrowImageBottomCN),i=n.getClientRect(t),i)){var u=Math.min(n.getClientRect(_d.body).width,_w.innerWidth),l=i.width,e=i.right,o=i.left;if(o<0?e+l>u?(n.addElementClass(n.ctrl,n.NarrowImageCN),r=(e-u)/2,o+r<=0&&(r-=ht),t.style.right=r+"px"):n.addElementClass(n.ctrl,n.NarrowImageRightCN):e>u&&(o<l?(n.addElementClass(n.ctrl,n.NarrowImageCN),r=o/2,e-r>=u&&(r+=ht),t.style.left=-1*r+"px"):n.elementHasClass(n.hoverContainerSub,"b_scpers")?i&&i.right>u?(a=u-i.right,t.style.left=a-ht+"px"):n.addElementClass(n.ctrl,n.NarrowImageRightCN):n.addElementClass(n.ctrl,n.NarrowImageRightCN)),s=n.ctrl===null||n.ctrl===void 0?void 0:n.ctrl.dataset.flyoutpos,h=s?3:1,i=n.getClientRect(t),c=Math.min(n.getClientRect(_d.body).height,_w.innerHeight)-i.bottom,v=b.clientHeight+Math.min(3.5,Object.keys(n.localCollectionsMap).length)*48,c<t.clientHeight/h||c<v/h)if(n.addElementClass(n.ctrl,n.NarrowImageBottomCN),s){var w=n.getClientRect(n.ctrlBtn),k=n.getClientRect(n.currentHoveredElement),d=_qs(".svbtnlbl",n.ctrlBtn);i=n.getClientRect(t);d&&(f=n.getClientRect(d),w.left-k.left<k.right-w.right?i.left-f.right<0&&f.right-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"):i.left-f.left<0&&f.left-i.right<0&&(t.style.bottom=n.ctrlBtn.clientHeight+"px"))}else{var y=n.ctrlBtn.clientLeft,g=n.ctrlBtn.clientWidth,p=t.clientLeft,nt=t.clientWidth;y>=p&&y+g<=p+nt&&(t.style.bottom=n.ctrlBtn.clientHeight+"px")}}}function nr(){y(l);ct(_ge("svctrlhvrpnltxt"),!0)}function ri(){t&&(n.addElementClass(n.ctrl,n.HasFlyoutCN),dt(),n.standalone||ii(),vt&&n.standalone||(n.logFlyoutShown(n.currentHoveredElement),vt=!0),sj_evt.fire("onResetScroll"),p=!0,ti())}function nt(){t&&(n.removeElementClass(n.ctrl,n.HasFlyoutCN),y(),ti(),p=!1)}function o(){nr();p||ri()}function ui(){o();sj_evt.fire("prismFocusChange",n.currentHoveredElement)}function tr(i){i.relatedTarget&&(n.getKeepFlyoutActive()||(sj_pd(i),sj_sp(i),n.addElementClass(n.ctrl,n.HasFlyoutCN),n.logSvBtnHoverEvent(),n.hoverContainerSub&&n.addElementClass(n.hoverContainerSub,"b_schvr"),sj_evt.fire("onSaveHover"),t&&(st&&!v?v=sb_st(ui,st):ui())))}function ir(t){if(t.type==="focusout"){if(n.shiftKeyDown){n.currentFocusTarget&&n.currentFocusTarget.focus();t.stopImmediatePropagation();sj_sp(t);sj_pd(t);return}o();n.elementHasClass(f,n.FlyoutActiveCN)?n.nextFocusable.focus():s.focus();return}if(!n.getKeepFlyoutActive()){var i=t.relatedTarget;if(i){if(n.elementContains(n.ctrl,i))return;if(n.isElementInSpaceOfAnother(n.hoverContainer,i))return}n.clearCurrentHoveredElement();t.type==="mouseleave"&&(n.removeElementClass(n.ctrl,n.HasFlyoutCN),nt())}}function rr(t){var i=n.elementsFromPoint(t.clientX,t.clientY);i&&i.length>1&&i[1].click()}function fi(t){var i=t[n.TargetAttr];si_ct(i,!1,t);n.logLinkClick(n.currentHoveredElement,tt);n.standalone&&(sj_evt.fire("onNewTabOpenRequest",i.getAttribute("href")),t.preventDefault());sj_sp(t)}function y(t){var o,i,u,h;if(s&&(n.removeElementClass(s,n.FlyoutActiveCN),o=t==it,n.setKeepFlyoutActive(o),n.getKeepFlyoutActive()?n.addElementClass(n.ctrl,"b_scnapd"):n.removeElementClass(n.ctrl,"b_scnapd")),!t){s=null;sj_evt.fire(n.VisualStateChangedEN,1);return}n.elementHasClass(n.ctrl,"b_geterr")&&(e.textContent=d[3],n.removeElementClass(e,n.errStateInvisibleCN),n.addElementClass(e,n.errStateVisibleCN),t=f);n.addElementClass(t,n.FlyoutActiveCN);t==l&&(n.addElementClass(r,n.FlyoutActiveCN),lt());s=t;i=null;switch(t){case l:u=_ge("svctrlpckr");u?(h=u.getAttribute("aria-expanded")==="false",i=h?3:4):i=3;break;case f:i=5}sj_evt.fire(n.VisualStateChangedEN,i)}function ur(){i&&(wt(),sj_evt.fire(n.VisualStateChangedEN,2))}function ei(t,i,r){var u=n.localSavedItemsMap[t||n.currentElementMid];u&&u.numCollections>1?sj_evt.fire(n.ChevronToggleCollListEN):n.handleSaveClick(n.currentElementCollId||n.latestCollId,"Btn",r,i)}function oi(n,t,i){o();ei(n,t,i)}function fr(){p?nt():o()}function er(n,t,i){ei(n,t,i);ct(_ge("svctrlhvrpnltxt"),!0)}var vt=!1,tt,p=!1,s,r,h,u,w,it,f,e,c,rt,b,ut,k,a,t,l,ft,i,yt,et,ot,pt,st=0,v,d,g=null,ht=5;n.isCreateDialogShowing=!1;n.onSaveControlClicked=oi;n.toggleFlyout=fr;n.onSaveControlIcnClicked=er;li()}(SvCtrlV2||(SvCtrlV2={})),function(n){function l(){s.scrollTop=0}function b(t){var r=t.currentTarget,i=r.getAttribute(n.CollectionIdDataAttribute),f=r.getAttribute(n.KCTDataAttr),u=n.currentHoveredElement;if(i||f)sj_sp(t),sj_pd(t),t.stopImmediatePropagation();else return!0;if(n.logCollLstClick(n.currentHoveredElement,i),i==n.CustomCollDummyId){n.addToNewCollection(n.defOrCustCollName,n.currentHoveredElement,function(){p(n.CustomCollDummyId)});return}r.hasAttribute(n.SavedDataAttr)?n.removeFromCollection(i,c,u):n.addToCollection(i,u,c)}function a(n){var t=n;if(/\/th(\/.*|)\?/i.test(n)){var i=n.split("?"),r=i[0],u=i[1];t=r+"?"+u.replace(/&?\b[whrc]=\d+/gi,"")+w}return t}function k(t){var u=t[1],r=t[2],i=_qs("["+n.CollectionIdDataAttribute+'="'+u+'"] img',n.collectionList);i&&(r?i.src=a(r):i.removeAttribute("src"))}function r(t,i,r){r===void 0&&(r=!1);var u=r?function(n){t.insertBefore(n,t.firstChild)}:function(n){t.appendChild(n)};n.iterateThroughList(i,u)}function i(t,i){var r=function(n,i){i&&t.setAttribute(n,i)};n.iterateOverObject(i,r)}function u(n,t){return sj_ce(n,null,t)}function d(t){var f,y=t[1],p=t[2],w=t[3],v=t[4],k=t[5],d=t[6],h,e,c,l,s;n.collectionList&&(h=u("div","b_svcimg"),e=sj_ce("img"),i(e,{role:"presentation"}),sj_be(e,"error",function(){e.removeAttribute("src")}),v&&(e.src=a(v)),r(h,[e]),c=u("div","b_svclnk"),l=u("p","b_ignbt"),l.textContent=w,r(c,[l]),s=u("li","b_svcitm"),i(s,(f={},f[n.CollectionIdDataAttribute]=p||null,f[n.KCTDataAttr]=k||null,f.tabindex="-1",f.role="option",f["aria-selected"]="false",f)),d&&o(s),r(s,[h,c]),r(n.collectionList,[s],y),n.addClickListener(s,b,!0,!1))}function e(r){var u,e;l();u=!1;r===null||r===undefined?(e=f.getAttribute("aria-expanded"),e!=="false"||h||(n.logCollExpandClick(n.currentHoveredElement),h=!0),u=e==="true"?!1:!0):u=r;i(f,{"aria-expanded":u?"true":"false"});u?n.addElementClass(t,"xpnd"):n.removeElementClass(t,"xpnd");u&&sj_evt.fire(n.CollListExpandEN);n.standalone&&sj_evt.fire(n.VisualStateChangedEN,u?4:3)}function v(t){return _qs("["+n.CollectionIdDataAttribute+"='"+t+"']",n.collectionList)}function o(t){var r;i(t,(r={},r[n.SavedDataAttr]="1",r["aria-selected"]="true",r))}function y(t){var r;t.removeAttribute(n.SavedDataAttr);i(t,(r={},r["aria-selected"]="false",r))}function g(n){var i=n[1],t=v(i);t&&o(t)}function nt(n){var i=n[1],t=v(i);t&&y(t)}function tt(t){var i=t[1];n.iterateThroughList(Array.prototype.slice.call(n.collectionList.childNodes),function(t){i&&t.getAttribute(n.CollectionIdDataAttribute)in i?o(t):y(t)})}function it(t){var i;n.isCreateDialogShowing||(t.keyCode===38?(_d.activeElement.previousElementSibling&&_d.activeElement.previousElementSibling.focus(),sj_sp(t),sj_pd(t)):t.keyCode===40&&(_d.activeElement===n.collectionList?(i=_qs(".b_svcitm"))===null||i===void 0?void 0:i.focus():_d.activeElement.nextElementSibling&&_d.activeElement.nextElementSibling.focus(),sj_sp(t),sj_pd(t)))}function p(t){if(!t||!n.collectionList)return!1;var i=_qs("[".concat(n.CollectionIdDataAttribute,'="').concat(t,'"]'),n.collectionList);return i?(n.collectionList.removeChild(i),!0):!1}function rt(){n.collectionList=_ge("svctrllst");f=_ge("svctrlpckr");s=_ge("svctrllstw");t=_ge("svctrlhvrpnlbtn");t&&n.addClickListener(t,function(){return e()});sj_evt.bind("onCollRegister",d,!0);sj_evt.bind(n.CurrentCollIdSetEN,g);sj_evt.bind("onCurrentCollIdUnset",nt);sj_evt.bind("onChangeCollThumbnail",k);sj_evt.bind("onResetScroll",l);sj_evt.bind(n.HoverElementSetEN,tt);sj_evt.bind(n.ChevronToggleCollListEN,function(){return e(!0)});sj_evt.bind(n.ControlAppendedEN,function(){return e(!1)});sj_evt.bind("onSaveHover",function(){t||sj_evt.fire(n.CollListExpandEN)});n.collectionList&&n.addListenerToElement(n.collectionList,"keydown",it)}var f,s,t,h=!1,c="ColLst",w="&w=40&h=40&c=7&r=0";n.removeCollectionFromPicker=p;rt()}(SvCtrlV2||(SvCtrlV2={})),function(n){function t(t){n.fireOverlapping(t);sj_sp(t);n.onSaveControlClicked(n.currentElementMid,n.currentHoveredElement,!0)}function i(){n.ctrlBtn&&n.addClickListener(n.ctrlBtn,t,!0)}i()}(SvCtrlV2||(SvCtrlV2={}))